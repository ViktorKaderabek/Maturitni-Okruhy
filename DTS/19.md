<p align="right" style="font-size: 80px;">#9</p>

# Protokoly pro překlad adres: ARP, RARP, NAT, PAT, DHCP, BootP.

## ARP protokol 

 ### Ip Adresa
 - IP adresa je 32-bitové číslo, které slouží jako adresa (identifikátor) pro dané zařízení. 
 - Pěkné přirovnání je číslo popisné a orientační.
 - IP adresa se zapisuje jako čtyři osmibitové bloky (oktety) oddělené tečkou – binární zápis se převádí na decimální čísla. Příklady: 192.168.20.3 nebo 10.211.6.90.
 - Od MAC adresy se liší tím, že ji můžeme snadno přiřadit nebo odebrat jakékoliv NIC. 
 - MAC adresa je popisné číslo, IP adresa orientační. 

- Protokol ARP specifikuje věci týkající překladu IP adres na MAC adresy. Základem je ARP cache

 ### ARP cache 
- Představme si, že jsme administrátor sítě se dvěma počítači, jednou tiskárnou, a jedním routerem. Aby PC spolu mohli např. sdílet soubory, nebo tisknout a připojit se na internet, musíme všechny 4 zařízení obejít, a dát jim IP adresy (v realitě je tohle automatizované, dělá to DHCP server, tohle jen pro jednoduchost). Naše síť bude tedy vypadat takto:

- Pokud vidíte v IP adresách nějakou pravidelnost, vidíte správně – IP adresy nejsou přidělovány jen tak náhodně, a můžete z nich vyčíst spoustu informací. Jinak, diagram i s IP adresami je reálný příklad (konkrétně mojí) sítě. Switch IP adresu nedostane, protože jenom přeposílá rámce – pro komunikující zařízení je de facto transparentní (nevědí, že mezi nimi nějaký switch je).

- ARP cache všech zařízení je na začátku prázdná (buď mohou být nová, nebo je cache resetovaná). Nyní nastane případ, že z PC1 potřebujeme tisknout – takže budeme posílat pakety na 192.168.4.3. Na to potřebujeme zjistit MAC adresu tiskárny. Pošleme tedy dotaz všem zařízením na síti: „Jaká NIC má IP adresu 192.168.4.3 ?“ Odpoví nám tiskárna – pošle svoji MAC adresu. PC1 si ji zapíše do ARP cache, a poté může posílat rámce s příkazy k tisku.

![image](https://user-images.githubusercontent.com/66387359/154036346-29661fe7-8dfe-4519-abef-b98d17bfa4d8.png)


```
      192.168.2.1 --> E5:25:35:AD:C6:78
      192.168.2.18 --> 3D:45:11:FE:F4:09
      192.168.2.9 --> 90:01:23:E4:A2:47
      192.168.2.3 --> 10:12:AC:C4:67:2E
```
 ### ARP paket 
 - je pouze balík dat (neboli přesně proud bitů), který v Ethernetovém rámci přijde do pole Data. 
 - Pro označení takového balíku dat (ať už request nebo response) máme termín ARP paket.
 - Pokud je hodnota v tomto poli menší než 1500, pak určuje délku pole Data v bytech
 - pokud je větší, pak se jedná o označení typu paketu, který je nesen rámcem 

### Struktura ARP paketu

![image](https://user-images.githubusercontent.com/66387359/154035923-711759e9-e96a-4b10-8db6-72e652b8d080.png)


### Protokol linkové vrstvy [2 byty]
- Říká nám typ rámce (jakým protokolem sestavuje NIC rámce), a tím pádem i adresu (která se označuje jako Hardwarová adresa), na kterou se ptáme – v našem případě to bude MAC adresa a Ethernet, pro který je tato hodnota 1.

### Protokol síťové vrstvy [2 byty]
- Typ adresy (jejího protokolu), podle které nám má její vlastník sdělit svou HW adresu. Náš případ: Cílové zařízení nám má poslat MAC adresu podle svojí IP adresy – tedy IP protokol. - Mimochodem, hodnoty se berou ze seznamu pro pole Ether type. Hodnota pro IP protokol je 2048.

### Délka adresy protokolu linkové vrstvy [1 bajt]
- Specifikuje délku HW adresy v bytech (ta je v šestém poli ARP paketu). Ethernetová MAC adresa je 6 bytů dlouhá => hodnota bude 6.

### Délka adresy protokolu síťové vrstvy [1 bajt]
- Specifikuje délku adresy (opět v bytech), pomocí které se tážeme (viz sedmé pole ARP paketu) – my se tážeme IP adresou, v poli tedy bude 4.

### Operace [2 byty]
- Odtud se dozvíme, zda se jedná o request (hodnota 1) nebo o reply (hodnota 2).

### HW adresa odesílatele & Protokolová adresa odesílatele
- V těchto polích bude MAC a IP adresa odesílajícího zařízení (v případě requestu toho PC, který se dotazuje; v případě response toho PC, který odpovídá). Důvodem je optimalizace
- jakmile PC obdrží ARP request, zapíše si IP a MAC z těchto polí do vlastní ARP cache.

### HW adresa příjemce
- V ARP requestu je toto pole vynechané – protože na tuto adresu se teprve ptáme (ARP request je tedy kratší než response). V ARP response je zde MAC toho zařízení, které posílalo ARP request.

### Protokolová adresa příjemce
- V requestu je to IP adresa, ke které chceme získat MAC. V response je to opět IP adresa toho, kdo poslal ARP request.

### Simulace 
https://www.itnetwork.cz/site/zaklady/site-adress-resolution-protocol uplne dole 

## RARP protokol
- Tento protokol je má opačnou funkci k protokolu ARP. Tedy překlad známé fyzické adresy na adresu IP. 
- Tento protokol bývá využíván na bezdiskových pracovních stanicích. 
- Ty totiž nemají kam si uložit záznamy o IP adresách a záznam o své IP adrese získávají ze serveru Toto řešení ovšem vyžaduje přítomnost serveru RARP v síti.
- Postup je získání adresy je následující: bezdisková stanice vyšle všem hostitelům v síti paket RARP. Počítač, nakonfigurovaný jako server, vyhledá podle MAC adresy příslušnou IP adresu a odešle ji zpět.
- Pracovní stanice paket příjme a uloží si jej do své paměti. Protokol RARP nemusí být opakován až do opětovného restartu bezdiskové stanice.



 
 
 
 
 
 
